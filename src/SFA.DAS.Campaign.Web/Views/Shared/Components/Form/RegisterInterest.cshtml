@using System.Text
@using Microsoft.AspNetCore.Mvc.ModelBinding
@model SFA.DAS.Campaign.Web.Models.RegisterInterestModel

@{

    var errorOrder = new List<string>()
    {
        "FirstName",
        "LastName",
        "Email",
        "Route",
        "AcceptTandCs"
    };

    var action = (Model.Version == 2) ? "indexv2" : "index";
    var submitButtonText = (Model.Version == 2) ? "Keep me updated" : "Register interest";
}

    <form asp-controller="RegisterInterest" asp-action="@action">
        @{ if (Model.Version == 1)
            {
                <h2 class="heading-m">Keep me up to date with the latest information</h2>
            }
        }

        <div class="form-validation-summary" style="@(ViewData.ModelState.IsValid ? " display: none" : "" )">
            <h3 class="heading-s form-validation-summary__heading">Sorry but there seems to be a problem with your registration</h3>
            <ul class="form-validation-summary__list">
                @{
                    var errorStringBuilder = new StringBuilder();
                    var errorCount = ViewData.ModelState.ErrorCount;

                    foreach (var error in errorOrder)
                    {
                        if (ViewData.ModelState[error]?.ValidationState == ModelValidationState.Invalid)
                        {
                            var errorKey = error == "Route" ? "rbApprentice" : error;
                            errorStringBuilder.Append($" <li><a href =\"#{errorKey}\" class=\"form-validation-summary__link\">{Model.ValidationMessages[error]}</a></li>");
                        }
                    }
                }
                @Html.Raw(errorStringBuilder.ToString())
            </ul>
        </div>
        <div class="form-group" das-validation-for="FirstName" das-validationerror-class="form-group-validation-error">
            <label class="label visually-hidden" asp-for="FirstName">
                First name
            </label>
            <input id="FirstName" class="input" asp-for="FirstName" type="text" placeholder="First name" autocomplete="given-name">
        </div>

        <div class="form-group" das-validation-for="LastName" das-validationerror-class="form-group-validation-error">

            <label class="label visually-hidden" asp-for="LastName">
                Last name
            </label>
            <input class="input" asp-for="LastName" type="text" placeholder="Last name" autocomplete="family-name">
        </div>
        <div class="form-group" das-validation-for="Email" das-validationerror-class="form-group-validation-error">

            <label class="label visually-hidden" asp-for="Email">
                Email Address
            </label>
            <input class="input" asp-for="Email" type="text" placeholder="Email address" autocomplete="email">
        </div>
        <div class="form-group radios" das-validation-for="Route" das-validationerror-class="form-group-validation-error">
            <div class="radios__item">
                <input class="input radios__input" asp-for="Route" value="1" type="radio" id="rbApprentice" />
                <label class="radios__label" for="rbApprentice">I want to become an <span class="badge badge--apprentice">apprentice</span> </label>
            </div>
            <div class="radios__item">
                <input class="input radios__input" asp-for="Route" value="2" type="radio" id="rbEmployer" />
                <label class="radios__label" for="rbEmployer">I want to <span class="badge badge--employer">employ</span> an apprentice</label>
            </div>
        </div>
        <div class="form-group" das-validation-for="AcceptTandCs" das-validationerror-class="form-group-validation-error">
            <div class="checkboxes__item">
                <input class="checkboxes__input" asp-for="AcceptTandCs" type="checkbox" value="true">
                <label class="checkboxes__label" asp-for="AcceptTandCs">
                    I'd like to receive more information about apprenticeships from the Education and Skills Funding Agency via email.
                </label>
            </div>
            <p>It's easy to unsubcribe if you change your mind, and we'll never share your email address with anyone else. To find out how we handle your personal data, please visit our <a asp-controller="Home" asp-action="Privacy">privacy notice</a>.</p>
        </div>

        <input asp-for="ReturnUrl" type="hidden" value="@Model.ReturnUrl" />
        <button formnovalidate="true" class="button button-inverted " name="registerInterestSubmit" type="submit" id="btn-register-interest-complete">@submitButtonText</button>
    </form>
